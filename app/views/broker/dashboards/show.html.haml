%div
  #loader.loader
%div#table


:javascript

   function removeLoader(){
    $( "#loader" ).fadeOut(500, function() {
      $( "#loader" ).remove();
    });
  }

  function infiniteScroll(){

    if ($('#infinite-scrolling').size() > 0) {
      $(window).on('scroll', function() {
        var url;
        url = $('.pagination .next a').attr('href');
        if (url && $(window).scrollTop() > $(document).height() - $(window).height() - 60) {
          $('.pagination').html('<img src="/assets/ajax-loader.gif" alt="Loading..." title="Loading..." />');
          $.getScript(url);
        }
      });
    }
  }

  $(window).load(function(){
    $.ajax({
          url: '/broker/dashboard/show_table',
          type: 'GET',
          dataType: 'html',
          success: function(response) {
            removeLoader()
            $('#table').html(response)
            infiniteScroll()
          }
      });
  });



